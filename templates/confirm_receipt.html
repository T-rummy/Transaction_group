{% extends "base.html" %}

{% block content %}
<div class="fade-in" style="max-width: 800px; margin: 0 auto;">
    <div class="text-center" style="margin-bottom: 32px;">
        <h1 class="text-3xl font-bold text-primary" style="margin-bottom: 8px;">‚úÖ Confirm Receipt</h1>
        <p class="text-secondary">Review and edit the extracted information before saving</p>
    </div>
    
    <div class="card" style="padding: 32px;">
        <form action="/confirm_receipt" method="POST" class="space-y-6">
            <div class="form-group">
                <label class="form-label">Business Name</label>
                <input type="text" name="name" value="{{ receipt_data.name }}" class="form-input" required>
            </div>
            
                               <div class="form-group">
                       <label class="form-label">Amount ($)</label>
                       <input type="number" step="0.01" name="amount" value="{{ receipt_data.amount if receipt_data.amount > 0 else '' }}" class="form-input" required placeholder="Enter amount">
                       {% if receipt_data.amount <= 0 %}
                       <p class="text-sm text-orange-600 mt-1">‚ö†Ô∏è Amount could not be automatically detected. Please enter it manually.</p>
                       {% endif %}
                   </div>
            
            <div class="form-group">
                <label class="form-label">Category</label>
                <select name="category" class="form-select">
                    <option value="Food" {% if receipt_data.category == 'Food' %}selected{% endif %}>Food & Dining</option>
                    <option value="Travel" {% if receipt_data.category == 'Travel' %}selected{% endif %}>Travel</option>
                    <option value="Transportation" {% if receipt_data.category == 'Transportation' %}selected{% endif %}>Transportation</option>
                    <option value="Bills & Utilities" {% if receipt_data.category == 'Bills & Utilities' %}selected{% endif %}>Bills & Utilities</option>
                    <option value="Academic" {% if receipt_data.category == 'Academic' %}selected{% endif %}>Academic</option>
                    <option value="Health" {% if receipt_data.category == 'Health' %}selected{% endif %}>Health & Wellness</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label">Date</label>
                <input type="text" value="{{ receipt_data.date }}" class="form-input" readonly>
                <p class="text-sm text-secondary mt-1">Date extracted from receipt</p>
            </div>
            
            <!-- Extracted Text Preview (for debugging) -->
            <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                <h3 class="font-semibold mb-2">üìÑ Extracted Text (First 10 lines):</h3>
                <div class="text-sm text-secondary max-h-32 overflow-y-auto">
                    {% for line in extracted_text %}
                        <div class="mb-1">{{ line }}</div>
                    {% endfor %}
                </div>
            </div>
            
            <div class="flex space-x-4">
                <button type="submit" class="btn btn-primary flex-1">
                    üíæ Save Transaction
                </button>
                <a href="/scan_receipt" class="btn btn-outline flex-1">
                    üîÑ Scan Another Receipt
                </a>
            </div>
        </form>
    </div>
    
    <!-- Help Section -->
    <div class="mt-6 card" style="padding: 24px;">
        <h3 class="font-semibold mb-3">üîç How it works:</h3>
        <div class="text-sm text-secondary space-y-2">
            <p>‚Ä¢ <strong>Business Name:</strong> Extracted from the top of the receipt</p>
            <p>‚Ä¢ <strong>Amount:</strong> Automatically detected as the largest currency amount</p>
            <p>‚Ä¢ <strong>Category:</strong> Guessed based on business name keywords</p>
            <p>‚Ä¢ <strong>Date:</strong> Found on the receipt, or defaults to today</p>
        </div>
        <p class="text-sm text-secondary mt-3">
            Feel free to edit any fields before saving. The system learns from your corrections to improve future scans.
        </p>
    </div>
</div>
{% endblock %} 