{% extends "base.html" %}

{% block content %}
<div class="fade-in" style="max-width: 800px; margin: 0 auto;">
    <div class="text-center" style="margin-bottom: 32px;">
        <h1 class="text-3xl font-bold text-primary" style="margin-bottom: 8px;">📷 Upload Receipt</h1>
        <p class="text-secondary">Upload a receipt image and manually enter the transaction details</p>
    </div>
    
    <div class="card" style="padding: 32px;">
        <form action="/upload_receipt" method="POST" enctype="multipart/form-data" class="space-y-6">
            <!-- File Upload Section -->
            <div class="form-group">
                <label class="form-label">Upload Receipt Image</label>
                <input type="file" name="receipt_image" accept="image/*" class="form-input" required>
                <p class="text-sm text-secondary mt-2">
                    Supported formats: JPG, PNG, GIF, HEIC. Upload a clear image of your receipt for reference.
                </p>
            </div>

            <!-- Transaction Details Section -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="form-group">
                    <label class="form-label">Transaction Name</label>
                    <input type="text" name="name" class="form-input" placeholder="e.g., Coffee at Starbucks" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Amount ($)</label>
                    <input type="number" step="0.01" name="amount" class="form-input" placeholder="0.00" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Category</label>
                    <select name="category" class="form-input form-select" required>
                        <option value="">Select Category</option>
                        <option value="Food">🍽️ Food & Dining</option>
                        <option value="Transportation">🚗 Transportation</option>
                        <option value="Shopping">🛍️ Shopping</option>
                        <option value="Entertainment">🎬 Entertainment</option>
                        <option value="Bills">💳 Bills & Utilities</option>
                        <option value="Healthcare">🏥 Healthcare</option>
                        <option value="Education">📚 Education</option>
                        <option value="Travel">✈️ Travel</option>
                        <option value="Other">📦 Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Date</label>
                    <input type="date" name="date" class="form-input" value="{{ today }}" required>
                </div>
            </div>

            <!-- Additional Details (Optional) -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="form-group">
                    <label class="form-label">Location (Optional)</label>
                    <input type="text" name="location" class="form-input" placeholder="e.g., Downtown Mall">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Notes (Optional)</label>
                    <input type="text" name="notes" class="form-input" placeholder="Any additional notes">
                </div>
            </div>
            
            <div class="flex gap-4">
                <button type="submit" class="btn btn-primary flex-1">
                    💾 Save Transaction with Receipt
                </button>
                <a href="{{ url_for('index') }}" class="btn btn-secondary flex-1">
                    ❌ Cancel
                </a>
            </div>
        </form>
        
        <!-- Tips Section -->
        <div class="mt-8 p-4 bg-blue-50 rounded-lg">
            <h3 class="font-semibold mb-2">💡 Tips for Best Results:</h3>
            <ul class="text-sm text-secondary space-y-1">
                <li>• Upload a clear, well-lit image of your receipt</li>
                <li>• Make sure the total amount is clearly visible</li>
                <li>• The receipt image will be stored for your records</li>
                <li>• You can always edit the transaction details later</li>
                <li>• Use the location field to remember where you made the purchase</li>
                <li>• Add notes for any special circumstances or details</li>
            </ul>
        </div>
    </div>
</div>

<script>
// File input validation
document.querySelector('input[type="file"]').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        // Show file name
        const fileName = file.name;
        console.log('Selected file:', fileName);
        
        // Validate file size
        const sizeInMB = file.size / (1024 * 1024);
        if (sizeInMB > 10) {
            alert('File is too large. Please select a smaller image (max 10MB).');
            e.target.value = '';
            return;
        }
        
        // Validate file type
        const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/heic', 'image/heif'];
        if (!allowedTypes.includes(file.type)) {
            alert('Invalid file type. Please select a JPG, PNG, GIF, or HEIC image.');
            e.target.value = '';
            return;
        }
    }
});
</script>
{% endblock %} 